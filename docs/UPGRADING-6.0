=head1 Upgrading to RTIR 6.0

The following describes some of the more significant changes
to RTIR 6.0 from earlier versions. The general L<UPGRADING> document
describes the steps to upgrade from a previous version of RTIR.

To align version numbers more clearly, the initial released version
of RTIR 6 is 6.0.1, which should be run with RT 6.0.1.

=head2 Notable Changes

=over

=item *

RTIR queues now use the new page layout system released on RT 6. This
means the create, display, and update pages for RTIR queues are completely
configurable. You can add or remove all components to make each queue work
for you. See the next section for details on additional special configuration
for Incidents.

As part of this update, two RTIR-specific configurations are updated.
In C<%CustomFieldGroupings> and C<%InlineEditPanelBehavior>, RTIR now uses
the key "RT::Ticket" just like RT, instead of previous "RTIR::Ticket".
If you had custom configurations for these two options, update your
"RTIR::Ticket" entries to "RT::Ticket". If you had an existing "RT::Ticket"
section, merge the two together.

=item *

RTIR now provides different page layouts for Incidents based on the value
of the Classification custom field. This feature uses RT 6's page layout
system to show different custom fields and widgets depending on the type
of incident being handled.

By default, RTIR creates page layouts for each Classification value
(Spam, Query, System Compromise, etc.) with a basic set of custom fields
including IP and Domain. These layouts provide a framework that you can
customize by adding relevant custom fields for each incident type.

When viewing or editing an Incident, the page layout will automatically
adjust based on the Classification value. If no Classification is set,
the default Incident layout is used.

To customize these layouts, create custom fields and apply them to the
Incidents queue, then update the CustomFieldGroupings configuration to
include the fields in the appropriate classification groupings.

If you prefer to use the same layout for all Incidents regardless of
Classification, you can disable this feature by going to Admin > Custom
Fields > Classification > Page Layouts tab. Under "Layouts for Display",
set each Classification value to use "Default" instead of the specific
layout names.

=item *

The following default RTIR homepage elements have been converted
to RT saved searches and the previous mason templates have been
removed.

    html/RTIR/Elements/NewReports
    html/RTIR/Elements/UserDueIncidents
    html/RTIR/Elements/NobodyDueIncidents
    html/RTIR/Elements/DueIncidents

The new saved searches work the same as the previous components.

Previously you could customized the content of these components using the
C<%RTIRSearchResultFormats> option by setting custom formats for C<NewReports>
or C<DueIncidents> entries. You can now modify this format directly in
the web UI by editing the saved search.

=item *

As with core RT, saved searches, including the ones noted above, can now be
configured to refresh automatically. This new feature replaces the Refresh
component on the home page that refreshed the entire page.

See the RT 6 upgrading documentation for details on the update to refresh
features.

=item *

The Iframe option for adding research tools to the lookup pages in RTIR
previously configured with C<$RTIRIframeResearchToolConfig> has been removed.
Browsers are becoming much more restrictive when loading content in Iframes
and many websites are also adding code to block them from being loaded in
Iframes. In our testing, the default example configurations provided with
RTIR no longer worked and we didn't find other replacements that would
work by loading them in an Iframe.

=item *

Time inputs have been removed from the Bulk Abandon page for incidents because it
is unclear which incident ticket the time should be recorded on. As part of this
update the time input for Reply All/Reporters was moved from
C<html/RTIR/Incident/Reply/index.html> to C<html/RTIR/Incident/Elements/ReplyForm>.
The callback C<AfterTimeWorked> is moved to a similar location in C<ReplyForm>
and is called C<AfterWorked>.

=item *

The Description custom field has been migrated to RT's core Description
field. As a new core ticket field in RT, "Description" now has its own widget on
create and display pages. You can edit your RTIR page layouts to change the
location or even remove the widget, if desired.

The automatic upgrade steps will move existing content on Incident queues to
the new Description field because on a default RTIR installation, the
Description custom field was applied only to Incidents. If you applied
Description to other queues, that content will not be migrated automatically.

=item *

RTIR provides custom pages for Incident "Bulk Abandon" and Incident Report
"Bulk Reject". The format for these ticket listings is defined in the
C<%RTIRSearchResultFormats> configuration via the entries "AbandonIncidents"
and "RejectReports". Previously these pages were using a default format rather
than the format defined in these configurations. This is now fixed and the
pages use the correct custom configurations.

This is notable on Bulk Reject for Incident Reports because the custom format
includes a useful custom column "Has Incident", which shows any linked Incidents.
That column is now available again.

=back

=head2 New Lookup Tools

RTIR 6 adds a few new default lookup tools for finding additional
information about incident data, like domains and IP addresses.

The active lookup tools can be managed with the C<@RTIRResearchTools>
configuration options. If you don't want some tools presented in
the interface, update this configuration in C<RT_SiteConfig.pm> and
remove them from the list.

=over

=item *

IPinfo.io provides a service that returns metadata for provided IP
addresses. They offer a base free plan and various other plans
that offer more information at higher levels.

To enable this lookup tool, create an account and token at IPinfo.io
and set C<$LookupIPinfoToken>.

=back

=cut
